<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Copy MongoDB Index Definitions" /><meta name="author" content="Alex Bevilacqua" /><meta property="og:locale" content="en_US" /><meta name="description" content="To support your application’s workload properly, you’ll want to ensure you’re creating indexes to support your queries. When doing this in a development environment, unless the the Driver or ODM in use allows you to manage index definitions via annotations in code (and you use that feature) it’s possible your development cluster’s indexes can diverge from that in production." /><meta property="og:description" content="To support your application’s workload properly, you’ll want to ensure you’re creating indexes to support your queries. When doing this in a development environment, unless the the Driver or ODM in use allows you to manage index definitions via annotations in code (and you use that feature) it’s possible your development cluster’s indexes can diverge from that in production." /><link rel="canonical" href="https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" /><meta property="og:url" content="https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" /><meta property="og:site_name" content="ALEX BEVILACQUA" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-24T06:24:14-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Copy MongoDB Index Definitions" /><meta name="twitter:site" content="@alexbevi" /><meta name="twitter:creator" content="@Alex Bevilacqua" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Copy MongoDB Index Definitions","dateModified":"2021-09-30T07:10:12-04:00","datePublished":"2021-09-24T06:24:14-04:00","url":"https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/"},"author":{"@type":"Person","name":"Alex Bevilacqua"},"description":"To support your application’s workload properly, you’ll want to ensure you’re creating indexes to support your queries. When doing this in a development environment, unless the the Driver or ODM in use allows you to manage index definitions via annotations in code (and you use that feature) it’s possible your development cluster’s indexes can diverge from that in production.","@type":"BlogPosting","@context":"https://schema.org"}</script><title>Copy MongoDB Index Definitions | ALEX BEVILACQUA</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-36490021-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-36490021-1'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6215800856413580" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.5.7/galleria.min.js"></script><link href="//cdnjs.cloudflare.com/ajax/libs/galleria/1.5.7/themes/classic/galleria.classic.min.css" media="screen, projection" rel="stylesheet" type="text/css" /><style> /* This rule is read by Galleria to define the gallery height: */ .galleria{ width: 700px; height: 400px; background: #000 } .responsive-wrap iframe{ max-width: 100%;}</style><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/images/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ALEX BEVILACQUA</a></div><div class="site-subtitle font-italic">my little corner of the interwebs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/alexbevi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/alexbevi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['alex','alexbevi.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://linkedin.com/in/alexbevi" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/195509" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <a href="https://www.facebook.com/alexbevi" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a> <a href="https://reddit.com/user/alexbevi" aria-label="reddit" target="_blank" rel="noopener"> <i class="fab fa-reddit"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog"> Blog </a> </span> <span> <a href="/2021"> 2021 </a> </span> <span> <a href="/09"> 09 </a> </span> <span> <a href="/24"> 24 </a> </span> <span>Copy MongoDB Index Definitions</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Copy MongoDB Index Definitions</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 24, 2021, 6:24 AM -0400" > Sep 24 <i class="unloaded">2021-09-24T06:24:14-04:00</i> </span> by <span class="author"> Alex Bevilacqua </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 30, 2021, 7:10 AM -0400" > Sep 30 <i class="unloaded">2021-09-30T07:10:12-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="549 words">3 min</span></div></div><div class="post-content"><p>To support your application’s workload properly, you’ll want to ensure you’re <a href="https://docs.mongodb.com/manual/tutorial/create-indexes-to-support-queries/">creating indexes to support your queries</a>. When doing this in a development environment, unless the the <a href="https://docs.mongodb.com/drivers/">Driver or ODM</a> in use allows you to manage index definitions via annotations in code (and you use that feature) it’s possible your development cluster’s indexes can diverge from that in production.</p><p>The following script will allow you to quickly generate all index creation commands for your cluster in a way that can be copy/pasted to another cluster.</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">generateCreateIndexesCommands</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">getIndexName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">v</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">v</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span><span class="p">)</span>
        <span class="k">continue</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nx">name</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">_</span><span class="dl">"</span><span class="p">;</span>
      <span class="nx">name</span> <span class="o">+=</span> <span class="nx">k</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">_</span><span class="dl">"</span><span class="p">;</span>

      <span class="nx">name</span> <span class="o">+=</span> <span class="nx">v</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">name</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">126</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">truncateIndexName</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span><span class="dl">"</span><span class="s2">truncateIndexName</span><span class="dl">"</span><span class="p">]</span> <span class="o">||</span> <span class="kc">true</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">ensureBackground</span> <span class="o">=</span> <span class="nx">options</span><span class="p">[</span><span class="dl">"</span><span class="s2">ensureBackground</span><span class="dl">"</span><span class="p">]</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>

  <span class="nx">db</span><span class="p">.</span><span class="nx">getMongo</span><span class="p">().</span><span class="nx">getDBNames</span><span class="p">().</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="p">[</span><span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">config</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">local</span><span class="dl">"</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">x</span><span class="p">)).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">db</span><span class="p">.</span><span class="nx">getSiblingDB</span><span class="p">(</span><span class="nx">d</span><span class="p">).</span><span class="nx">getCollectionNames</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">getSiblingDB</span><span class="p">(</span><span class="nx">d</span><span class="p">).</span><span class="nx">getCollection</span><span class="p">(</span><span class="nx">c</span><span class="p">).</span><span class="nx">getIndexes</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">idPosition</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">_id_</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">idPosition</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">=</span> <span class="p">(</span><span class="nx">truncateIndexName</span><span class="p">)</span> <span class="p">?</span> <span class="nx">getIndexName</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">key</span><span class="p">)</span> <span class="p">:</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">key</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">ensureBackground</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// force all indexes to be created in the background</span>
            <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">background</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1">// remove the { _id: 1 } default index as it will exist already anyway</span>
      <span class="nx">keys</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">idPosition</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">keys</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">print</span><span class="p">(</span><span class="dl">"</span><span class="s2">db.getSiblingDB('</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">d</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">').</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">.createIndexes(</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">keys</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">)</span><span class="dl">"</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">})</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">generateCreateIndexesCommands</code> function will output all <a href="https://docs.mongodb.com/manual/reference/command/createIndexes/"><code class="language-plaintext highlighter-rouge">createIndexes</code></a> commands for the cluster including all options. The function can optionally be configured using the following parameters (in an object):</p><ul><li><code class="language-plaintext highlighter-rouge">truncateIndexName</code>: Limits an index definitions <code class="language-plaintext highlighter-rouge">name</code> field to less than 128 characters. Prior to MongoDB 4.2 (see <a href="https://jira.mongodb.org/browse/SERVER-32959">SERVER-32959</a>) this <a href="https://docs.mongodb.com/v4.2/reference/limits/#Index-Name-Length">Index Name Length limitation</a> existed and under certain circumstances, <a href="https://docs.mongodb.com/manual/core/index-compound/">compound index</a> auto naming could result in this limit being exceeded. (default: <code class="language-plaintext highlighter-rouge">true</code>)<li><code class="language-plaintext highlighter-rouge">ensureBackground</code>: Prior to MongoDB 4.2 (which introduced the <a href="https://docs.mongodb.com/v4.2/core/index-creation/#index-build-process">optimized build process</a>) indexes could be built in either the foreground or the background. Foreground index builds were fast and produced more efficient index data structures, but required blocking all read-write access to the parent database of the collection being indexed for the duration of the build. Background index builds were slower and had less efficient results, but allowed read-write access to the database and its collections during the build process.<br />This option ensure index definitions contain a <code class="language-plaintext highlighter-rouge">{ background: true }</code> option in case you want to copy the commands to a MongoDB 4.0 cluster (or earlier) and ensure index builds occur in the background. (default: <code class="language-plaintext highlighter-rouge">false</code>)</ul><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// run with no options</span>
<span class="nx">generateCreateIndexesCommands</span><span class="p">()</span>
<span class="c1">// run with options</span>
<span class="nx">generateCreateIndexesCommands</span><span class="p">({</span> <span class="na">truncateIndexName</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">ensureBackground</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</pre></table></code></div></div><p>Running this script will produce output such as the following:</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">getSiblingDB</span><span class="p">(</span><span class="dl">'</span><span class="s1">test</span><span class="dl">'</span><span class="p">).</span><span class="nx">foo</span><span class="p">.</span><span class="nx">createIndexes</span><span class="p">([{</span><span class="dl">"</span><span class="s2">v</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="dl">"</span><span class="s2">key</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">a</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="dl">"</span><span class="s2">b</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">a_1_b_1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">background</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span><span class="p">},{</span><span class="dl">"</span><span class="s2">v</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="dl">"</span><span class="s2">key</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">key</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">key_1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">collation</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">locale</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">en</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">caseLevel</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="dl">"</span><span class="s2">caseFirst</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">off</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">strength</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="dl">"</span><span class="s2">numericOrdering</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="dl">"</span><span class="s2">alternate</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">non-ignorable</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">maxVariable</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">punct</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">normalization</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="dl">"</span><span class="s2">backwards</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="dl">"</span><span class="s2">version</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">57.1</span><span class="dl">"</span><span class="p">}}])</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">getSiblingDB</span><span class="p">(</span><span class="dl">'</span><span class="s1">test</span><span class="dl">'</span><span class="p">).</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">createIndexes</span><span class="p">([{</span><span class="dl">"</span><span class="s2">v</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="dl">"</span><span class="s2">key</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">cuisine</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">cuisine_1_name_1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">partialFilterExpression</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">rating</span><span class="dl">"</span><span class="p">:{</span><span class="dl">"</span><span class="s2">$gt</span><span class="dl">"</span><span class="p">:</span><span class="mi">5</span><span class="p">}}}])</span>
</pre></table></code></div></div><p>Did this script help you? Do you have any other options you’d like to see added? Let me know in the comments below … and happy coding ;)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/mongodb/'>MongoDB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mongodb/" class="post-tag no-text-decoration" >mongodb</a> <a href="/tags/indexes/" class="post-tag no-text-decoration" >indexes</a> <a href="/tags/queries/" class="post-tag no-text-decoration" >queries</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Copy MongoDB Index Definitions - ALEX BEVILACQUA&url=https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Copy MongoDB Index Definitions - ALEX BEVILACQUA&u=https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Copy MongoDB Index Definitions - ALEX BEVILACQUA&url=https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=Copy MongoDB Index Definitions - ALEX BEVILACQUA&url=https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/2021/07/28/adventure-games-1980-1999/">Journey into Adventure Games (1980-1999)</a><li><a href="/blog/2021/08/08/adventure-games-1980-1999-sorted-by-score/">Adventure Games (1980-1999): Sorted by Score</a><li><a href="/blog/2021/12/18/just-finished-sword-of-hope/">Just Finished - Sword of Hope</a><li><a href="/blog/2021/12/22/sanitarium/">Sanitarium (DreamForge Intertainment) - 1998</a><li><a href="/blog/2016/02/23/just-finished-shadowrun/">Just Finished - Shadowrun</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/redmine/">redmine</a> <a class="post-tag" href="/tags/rpg/">rpg</a> <a class="post-tag" href="/tags/adventure/">adventure</a> <a class="post-tag" href="/tags/book/">book</a> <a class="post-tag" href="/tags/snes/">snes</a> <a class="post-tag" href="/tags/jrpg/">jrpg</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/ruby/">ruby</a> <a class="post-tag" href="/tags/replication/">replication</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/2012/08/29/install-latest-mongodb-in-ubuntu/"><div class="card-body"> <span class="timeago small" > Aug 29, 2012 <i class="unloaded">2012-08-29T13:46:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Install Latest MongoDB in Ubuntu</h3><div class="text-muted small"><p> A couple projects I work on use MongoDB as the database, and I’m generally not satisfied to use the (often outdated) version that ships with Ubuntu. As a result, I wrote this script to automate fe...</p></div></div></a></div><div class="card"> <a href="/blog/2018/08/14/hello-mongodb/"><div class="card-body"> <span class="timeago small" > Aug 14, 2018 <i class="unloaded">2018-08-14T15:31:04-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hello MongoDB</h3><div class="text-muted small"><p> As of August 13th, I am no longer a System Architect at DAC Group. I have a public post on LinkedIn that got some good traction, but to summarize it was time to move on. I’ve been a software engin...</p></div></div></a></div><div class="card"> <a href="/blog/2018/10/01/technical-services-engineering-at-mongodb/"><div class="card-body"> <span class="timeago small" > Oct 1, 2018 <i class="unloaded">2018-10-01T15:39:28-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Technical Services Engineering at MongoDB</h3><div class="text-muted small"><p> The goal of this post is to provide a first hand account of what it means to be a Technical Services Engineer at MongoDB, as well as what the journey getting to this point has looked like for me. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/2021/08/30/labyrinth/" class="btn btn-outline-primary" prompt="Older"><p>Labyrinth: The Computer Game (Lucasfilm Games) - 1986</p></a> <a href="/blog/2021/10/07/mongodb-versioned-api/" class="btn btn-outline-primary" prompt="Newer"><p>MongoDB Versioned API</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Loading comments from <a href="https://disqus.com/">Disqus</a> ...</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//alexbevi.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Copy MongoDB Index Definitions'; this.page.url = 'https://www.alexbevi.com/blog/2021/09/24/copy-mongodb-index-definitions/'; this.page.identifier = '/blog/2021/09/24/copy-mongodb-index-definitions/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/alexbevi">Alex Bevilacqua</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/redmine/">redmine</a> <a class="post-tag" href="/tags/rpg/">rpg</a> <a class="post-tag" href="/tags/adventure/">adventure</a> <a class="post-tag" href="/tags/book/">book</a> <a class="post-tag" href="/tags/snes/">snes</a> <a class="post-tag" href="/tags/jrpg/">jrpg</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/ruby/">ruby</a> <a class="post-tag" href="/tags/replication/">replication</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.alexbevi.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script type="text/javascript" src="/assets/js/lightbox.js"></script><link rel="stylesheet" href="/assets/css/lightbox.css">
