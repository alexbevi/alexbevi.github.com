<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="MongoDB Stable API" /><meta property="og:locale" content="en" /><meta name="description" content="MongoDB’s Versioned API was renamed to the Stable API, so this guide was updated to use the new terminology" /><meta property="og:description" content="MongoDB’s Versioned API was renamed to the Stable API, so this guide was updated to use the new terminology" /><link rel="canonical" href="https://www.alexbevi.com/blog/2021/10/07/mongodb-versioned-api/" /><meta property="og:url" content="https://www.alexbevi.com/blog/2021/10/07/mongodb-versioned-api/" /><meta property="og:site_name" content="ALEX BEVILACQUA" /><meta property="og:image" content=" https://www.alexbevi.com/images/mongodb-logo.png " /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-07T06:17:50-04:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content=" https://www.alexbevi.com/images/mongodb-logo.png " /><meta property="twitter:title" content="MongoDB Stable API" /><meta name="twitter:site" content="@alexbevi" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-20T10:35:00-04:00","datePublished":"2021-10-07T06:17:50-04:00","description":"MongoDB’s Versioned API was renamed to the Stable API, so this guide was updated to use the new terminology","headline":"MongoDB Stable API","image":" https://www.alexbevi.com/images/mongodb-logo.png ","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.alexbevi.com/blog/2021/10/07/mongodb-versioned-api/"},"url":"https://www.alexbevi.com/blog/2021/10/07/mongodb-versioned-api/"}</script><title>MongoDB Stable API | ALEX BEVILACQUA</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ALEX BEVILACQUA"><meta name="application-name" content="ALEX BEVILACQUA"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="/assets/lib/fonts/main.css"><link rel="stylesheet" href="/assets/lib/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css"><link rel="stylesheet" href="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="/assets/lib/glightbox/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="/assets/lib/simple-jekyll-search/simple-jekyll-search.min.js"></script> <script defer src="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.umd.min.js"></script> <script defer src="/assets/lib/glightbox/glightbox.min.js"></script> <script defer src="/assets/lib/clipboard/clipboard.min.js"></script> <script defer src="/assets/lib/dayjs/dayjs.min.js"></script> <script defer src="/assets/lib/dayjs/locale/en.js"></script> <script defer src="/assets/lib/dayjs/plugin/relativeTime.js"></script> <script defer src="/assets/lib/dayjs/plugin/localizedFormat.js"></script> <script defer src="/assets/lib/tocbot/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-36490021-1"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-36490021-1'); }); </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/lightgallery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/plugins/zoom/lg-zoom.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/css/lightgallery-bundle.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/css/lg-transitions.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/css/lg-zoom.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.1/css/lg-thumbnail.min.css" rel="stylesheet"><style> .inline-gallery-container { width: 100%; // set 60% height height: 0; padding-bottom: 65%; }</style><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6215800856413580" crossorigin="anonymous"></script><meta name="google-adsense-account" content="ca-pub-6215800856413580"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src=" /./images/avatar.png " width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">ALEX BEVILACQUA</a><p class="site-subtitle fst-italic mb-0">my little corner of the interwebs</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/specifications/" class="nav-link"> <i class="fa-fw fas fa-book"></i> <span>SPECIFICATIONS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/alexbevi " aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/alexbevi " aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['alex','alexbevi.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="@alexbevi@ruby.social" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="https://linkedin.com/in/alexbevi" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/195509" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a> <a href="https://www.facebook.com/alexbevi" aria-label="facebook" target="_blank" rel="noopener noreferrer" > <i class="fab fa-facebook"></i> </a> <a href="https://reddit.com/user/alexbevi" aria-label="reddit" target="_blank" rel="noopener noreferrer" > <i class="fab fa-reddit"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>MongoDB Stable API</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>MongoDB Stable API</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1633601870" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 7, 2021 </time> </span> <span> Updated <time data-ts="1745159700" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 20, 2025 </time> </span><div class="mt-3 mb-3"> <a href=" /images/mongodb-logo.png" class="popup img-link preview-img shimmer"><img src=" /images/mongodb-logo.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/alexbevi">Alex Bevilacqua</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="693 words" > <em>3 min</em> read </span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">MongoDB Stable API</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">MongoDB Stable API</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><blockquote class="prompt-info"><p>MongoDB’s <strong>Versioned API</strong> was renamed to the <strong>Stable API</strong>, so this guide was updated to use the new terminology</p></blockquote><p>The <a href="https://github.com/mongodb/specifications/blob/master/source/versioned-api/versioned-api.rst">Stable API For Drivers Specification</a> states <em>“When applications interact with MongoDB, both the driver and the server participate in executing operations. Therefore, when determining application compatibility with MongoDB, both the driver and the server behavior must be taken into account.”</em></p><p>As MongoDB <a href="https://www.mongodb.com/blog/post/new-quarterly-releases-starting-with-mongodb-5-0">moves toward more frequent releases (a.k.a. continuous delivery)</a>, they want to enable users to take advantage of rapidly released features, without exposing applications to incompatible server changes due to automatic server upgrades. A Stable API will help accomplish that goal (see <a href="https://www.mongodb.com/developer/products/mongodb/upgrade-fearlessly-stable-api/">“Upgrade Fearlessly with the MongoDB Stable API”</a>).</p><p>The Stable API encompasses the subset of MongoDB commands that applications commonly use to read and write data, create collections and indexes, and so on. We commit to keeping these commands backward-compatible in new MongoDB versions. We can add new features (such as new command parameters, new aggregation operators, new commands, etc.) to the Stable API, but only in backward-compatible ways.</p><h2 id="identifying-stable-api-commands"><span class="me-2">Identifying Stable API Commands</span><a href="#identifying-stable-api-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>From a mongo or <code class="language-plaintext highlighter-rouge">mongosh</code> shell connected to a 5.0+ cluster the following helper function can be used to determine which commands are included in a specific API version.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">printCommandsByAPIVersion</span><span class="p">(</span><span class="nx">version</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">version</span> <span class="o">=</span> <span class="nx">version</span><span class="p">.</span><span class="nf">toString</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">runCommand</span><span class="p">({</span> <span class="na">listCommands</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>
    <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">keys</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">commands</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">commands</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">commands</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">cmd</span><span class="p">.</span><span class="nx">apiVersions</span><span class="p">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="nx">version</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>  <span class="p">)</span> <span class="p">{</span>
            <span class="nx">commands</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span> <span class="na">version</span><span class="p">:</span> <span class="nx">db</span><span class="p">.</span><span class="nf">serverBuildInfo</span><span class="p">().</span><span class="nx">version</span><span class="p">,</span> <span class="na">apiVersion</span><span class="p">:</span> <span class="nx">version</span><span class="p">,</span> <span class="na">commands</span><span class="p">:</span> <span class="nx">commands</span><span class="p">.</span><span class="nf">sort</span><span class="p">()</span> <span class="p">};</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This can be used to print out the commands supported by a specific API Version (only version <code class="language-plaintext highlighter-rouge">"1"</code> for now):</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">printCommandsByAPIVersion</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="api-v1-commands"><span class="me-2">API v1 Commands</span><a href="#api-v1-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Note this is also <a href="https://mongodb.com/docs/manual/reference/stable-api-changelog/#database-commands">documented</a> now, however the output of the <code class="language-plaintext highlighter-rouge">printCommandsByAPIVersion</code> against a MongoDB 5.0 cluster would output the following:</p><p><code class="language-plaintext highlighter-rouge">abortTransaction</code>, <code class="language-plaintext highlighter-rouge">aggregate</code>, <code class="language-plaintext highlighter-rouge">authenticate</code>, <code class="language-plaintext highlighter-rouge">collMod</code>, <code class="language-plaintext highlighter-rouge">commitTransaction</code>, <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">createIndexes</code>, <code class="language-plaintext highlighter-rouge">delete</code>, <code class="language-plaintext highlighter-rouge">drop</code>, <code class="language-plaintext highlighter-rouge">dropDatabase</code>, <code class="language-plaintext highlighter-rouge">dropIndexes</code>, <code class="language-plaintext highlighter-rouge">endSessions</code>, <code class="language-plaintext highlighter-rouge">explain</code>, <code class="language-plaintext highlighter-rouge">find</code>, <code class="language-plaintext highlighter-rouge">findAndModify</code>, <code class="language-plaintext highlighter-rouge">getMore</code>, <code class="language-plaintext highlighter-rouge">hello</code>, <code class="language-plaintext highlighter-rouge">insert</code>, <code class="language-plaintext highlighter-rouge">killCursors</code>, <code class="language-plaintext highlighter-rouge">listCollections</code>, <code class="language-plaintext highlighter-rouge">listDatabases</code>, <code class="language-plaintext highlighter-rouge">listIndexes</code>, <code class="language-plaintext highlighter-rouge">ping</code>, <code class="language-plaintext highlighter-rouge">refreshSessions</code>, <code class="language-plaintext highlighter-rouge">saslContinue</code>, <code class="language-plaintext highlighter-rouge">saslStart</code>, <code class="language-plaintext highlighter-rouge">update</code></p><h2 id="stable-api-test"><span class="me-2">Stable API Test</span><a href="#stable-api-test" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The following test using the latest <code class="language-plaintext highlighter-rouge">master</code> branch of the <a href="https://github.com/mongodb/mongo-ruby-driver">Ruby Driver</a> can be used to test the behavior of an application with and without strict checking. This example sends a <a href="https://docs.mongodb.com/manual/reference/command/replSetGetStatus/"><code class="language-plaintext highlighter-rouge">replSetGetStatus</code></a> command to the server, and if the <code class="language-plaintext highlighter-rouge">strict</code> option is set shows the <code class="language-plaintext highlighter-rouge">APIStrictError</code> being raised:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># test.rb</span>
<span class="nb">require</span> <span class="s1">'bundler/inline'</span>
<span class="n">gemfile</span> <span class="k">do</span>
 <span class="n">source</span> <span class="s1">'https://rubygems.org'</span>
 <span class="n">gem</span> <span class="s1">'mongo'</span><span class="p">,</span> <span class="ss">github: </span><span class="s1">'mongodb/mongo-ruby-driver'</span><span class="p">,</span> <span class="ss">branch: </span><span class="s2">"master"</span>
<span class="k">end</span>

<span class="n">strict_api</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"true"</span>
<span class="c1"># connect to a MongoDB 5.0+ replica set</span>
<span class="n">client</span> <span class="o">=</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">([</span> <span class="s1">'alexs-mbp:27017'</span> <span class="p">],</span> <span class="ss">database: </span><span class="s1">'mydb'</span><span class="p">,</span> <span class="ss">replica_set: </span><span class="s1">'rs0'</span><span class="p">,</span> <span class="ss">server_api: </span><span class="p">{</span> <span class="ss">version: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">strict: </span><span class="n">strict_api</span> <span class="p">})</span>
<span class="k">begin</span>
 <span class="n">admin_client</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="s1">'admin'</span><span class="p">)</span>
 <span class="nb">p</span> <span class="n">admin_client</span><span class="p">.</span><span class="nf">database</span><span class="p">.</span><span class="nf">command</span><span class="p">(</span><span class="ss">replSetGetStatus: </span><span class="mi">1</span><span class="p">).</span><span class="nf">documents</span><span class="p">.</span><span class="nf">first</span>
<span class="k">rescue</span> <span class="no">Mongo</span><span class="o">::</span><span class="no">Error</span><span class="o">::</span><span class="no">OperationFailure</span> <span class="o">=&gt;</span> <span class="n">ex</span>
 <span class="nb">puts</span> <span class="n">ex</span>
<span class="k">ensure</span>
 <span class="n">client</span><span class="p">.</span><span class="nf">close</span>
<span class="k">end</span>
</pre></table></code></div></div><p>The above script can be tested by passing <code class="language-plaintext highlighter-rouge">true</code>/<code class="language-plaintext highlighter-rouge">false</code> as the first argument to validate the behavior of the driver in strict mode:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ruby test.rb
<span class="o">{</span><span class="s2">"set"</span><span class="o">=&gt;</span><span class="s2">"rs0"</span>, <span class="s2">"date"</span><span class="o">=&gt;</span>2021-05-14 14:49:33 UTC, <span class="s2">"myState"</span><span class="o">=&gt;</span>1, <span class="s2">"term"</span><span class="o">=&gt;</span>7, <span class="s2">"syncSourceHost"</span><span class="o">=&gt;</span><span class="s2">""</span>, <span class="s2">"syncSourceId"</span><span class="o">=&gt;</span><span class="nt">-1</span>, <span class="s2">"heartbeatIntervalMillis"</span><span class="o">=&gt;</span>2000, <span class="s2">"majorityVoteCount"</span><span class="o">=&gt;</span>1, <span class="s2">"writeMajorityCount"</span><span class="o">=&gt;</span>1, <span class="s2">"votingMembersCount"</span><span class="o">=&gt;</span>1, <span class="s2">"writableVotingMembersCount"</span><span class="o">=&gt;</span>1, <span class="s2">"optimes"</span><span class="o">=&gt;{</span><span class="s2">"lastCommittedOpTime"</span><span class="o">=&gt;{</span><span class="s2">"ts"</span><span class="o">=&gt;</span><span class="c">#&lt;BSON::Timestamp:0x00007fb303a1dc78 @seconds=1621003767, @increment=1&gt;, "t"=&gt;7}, "lastCommittedWallTime"=&gt;2021-05-14 14:49:27 UTC, "readConcernMajorityOpTime"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1d9d0 @seconds=1621003767, @increment=1&gt;, "t"=&gt;7}, "appliedOpTime"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1d868 @seconds=1621003767, @increment=1&gt;, "t"=&gt;7}, "durableOpTime"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1d700 @seconds=1621003767, @increment=1&gt;, "t"=&gt;7}, "lastAppliedWallTime"=&gt;2021-05-14 14:49:27 UTC, "lastDurableWallTime"=&gt;2021-05-14 14:49:27 UTC}, "lastStableRecoveryTimestamp"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1d340 @seconds=1621003737, @increment=1&gt;, "electionCandidateMetrics"=&gt;{"lastElectionReason"=&gt;"electionTimeout", "lastElectionDate"=&gt;2021-05-14 14:27:57 UTC, "electionTerm"=&gt;7, "lastCommittedOpTimeAtElection"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1cfa8 @seconds=0, @increment=0&gt;, "t"=&gt;-1}, "lastSeenOpTimeAtElection"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1ce40 @seconds=1620999663, @increment=1&gt;, "t"=&gt;6}, "numVotesNeeded"=&gt;1, "priorityAtElection"=&gt;1.0, "electionTimeoutMillis"=&gt;10000, "newTermStartDate"=&gt;2021-05-14 14:27:57 UTC, "wMajorityWriteAvailabilityDate"=&gt;2021-05-14 14:27:57 UTC}, "members"=&gt;[{"_id"=&gt;0, "name"=&gt;"Alexs-MBP:27017", "health"=&gt;1.0, "state"=&gt;1, "stateStr"=&gt;"PRIMARY", "uptime"=&gt;1300, "optime"=&gt;{"ts"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1c6c0 @seconds=1621003767, @increment=1&gt;, "t"=&gt;7}, "optimeDate"=&gt;2021-05-14 14:49:27 UTC, "syncSourceHost"=&gt;"", "syncSourceId"=&gt;-1, "infoMessage"=&gt;"", "electionTime"=&gt;#&lt;BSON::Timestamp:0x00007fb303a1c378 @seconds=1621002477, @increment=1&gt;, "electionDate"=&gt;2021-05-14 14:27:57 UTC, "configVersion"=&gt;1, "configTerm"=&gt;7, "self"=&gt;true, "lastHeartbeatMessage"=&gt;""}], "ok"=&gt;1.0, "$clusterTime"=&gt;{"clusterTime"=&gt;#&lt;BSON::Timestamp:0x00007fb3049dff30 @seconds=1621003767, @increment=1&gt;, "signature"=&gt;{"hash"=&gt;&lt;BSON::Binary:0x70203426668280 type=generic data=0x0000000000000000...&gt;, "keyId"=&gt;0}}, "operationTime"=&gt;#&lt;BSON::Timestamp:0x00007fb3049dfd00 @seconds=1621003767, @increment=1&gt;}</span>

<span class="nv">$ </span>ruby test.rb <span class="nb">true</span>
<span class="o">[</span>323:APIStrictError]: Provided apiStrict:true, but the <span class="nb">command </span>replSetGetStatus is not <span class="k">in </span>API Version 1 <span class="o">(</span>on alexs-mbp:27017<span class="o">)</span>
</pre></table></code></div></div><p>There are presently no plans or schedules to deprecate version 1, which is reinforced by the following excerpt from the internal technical design document: <em>The Versioned API frees us from this bind. We say that today’s semantics are part of the MongoDB API Version 1, and the new semantics are in Version 2. MongoDB servers will support both.</em></p><h2 id="additional-references"><span class="me-2">Additional References:</span><a href="#additional-references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://www.mongodb.com/docs/manual/reference/stable-api/">Reference Documentation</a><li><a href="https://github.com/mongodb/mongo/blob/master/src/mongo/db/STABLE_API_README.md">Architecture Documentation</a><li><a href="https://jira.mongodb.org/browse/DRIVERS-996">DRIVERS-996: Versioned MongoDB API for Drivers</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/mongodb/">MongoDB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/mongodb/" class="post-tag no-text-decoration" >mongodb</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA&url=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA&u=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F&text=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://service.weibo.com/share/share.php?title=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA&url=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Weibo" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://bsky.app/intent/compose?text=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA%20https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Bluesky" aria-label="Bluesky"> <i class="fa-fw fa-brands fa-bluesky"></i> </a> <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F&title=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit"> <i class="fa-fw fa-brands fa-square-reddit"></i> </a> <a href="https://www.threads.net/intent/post?text=MongoDB%20Stable%20API%20-%20ALEX%20BEVILACQUA%20https%3A%2F%2Fwww.alexbevi.com%2Fblog%2F2021%2F10%2F07%2Fmongodb-versioned-api%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Threads" aria-label="Threads"> <i class="fa-fw fa-brands fa-square-threads"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/2023/01/23/sam-and-max-hit-the-road/">Sam & Max Hit the Road (LucasArts) - 1993</a><li class="text-truncate lh-lg"> <a href="/blog/2023/02/01/leisure-suit-larry-2/">Leisure Suit Larry Goes Looking for Love (in Several Wrong Places) (Sierra On-Line) - 1988</a><li class="text-truncate lh-lg"> <a href="/blog/2023/02/07/kabul-spy/">Kabul Spy (Sirius Software) - 1982</a><li class="text-truncate lh-lg"> <a href="/blog/2023/02/07/eternam/">Eternam (Infogrames) - 1992</a><li class="text-truncate lh-lg"> <a href="/blog/2023/02/08/emmanuelle/">Emmanuelle (Coktel Vision) - 1989</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/adventure/">adventure</a> <a class="post-tag btn btn-outline-primary" href="/tags/mongodb/">mongodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/sierra-on-line/">Sierra On-Line</a> <a class="post-tag btn btn-outline-primary" href="/tags/drivers/">drivers</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/redmine/">redmine</a> <a class="post-tag btn btn-outline-primary" href="/tags/rpg/">rpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/sci/">SCI</a> <a class="post-tag btn btn-outline-primary" href="/tags/book/">book</a> <a class="post-tag btn btn-outline-primary" href="/tags/jrpg/">jrpg</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/blog/2024/07/12/call-stack-but-make-it-async/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1720797350" data-df="ll" > Jul 12, 2024 </time><h4 class="pt-0 my-2">Call Stack, But Make It Async!</h4><div class="text-muted"><p>Written by Neal Beeken (Blog, GitHub) - Canonical URL is at medium.com In a recent release of the MongoDB Node.js driver (v6.5.0), the team completed the effort of getting all our asynchronous op...</p></div></div></a></article><article class="col"> <a href="/blog/2022/10/06/from-engineering-to-product-management/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1665040407" data-df="ll" > Oct 6, 2022 </time><h4 class="pt-0 my-2">From Engineering to Product Management</h4><div class="text-muted"><p>I’ve spent my entire professional career as an engineering IC either churning out code, working on architectural challenges or helping to lead engineering teams (while still churning out code). Whe...</p></div></div></a></article><article class="col"> <a href="/blog/2022/09/09/performance-profiling-a-mongoid-issue-using-appprofiler/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1662720061" data-df="ll" > Sep 9, 2022 </time><h4 class="pt-0 my-2">Performance Profiling a Mongoid Issue Using AppProfiler</h4><div class="text-muted"><p>In MONGOID-4889 the claim was made that assignment of a large number of embedded documents to an instance of a model will take increasingly longer as the size of the list of documents to embed grow...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/blog/2021/09/24/copy-mongodb-index-definitions/" class="btn btn-outline-primary" aria-label="Older" ><p>Copy MongoDB Index Definitions</p></a> <a href="/blog/2021/10/21/ensuring-replica-set-priority-takeover-success/" class="btn btn-outline-primary" aria-label="Newer" ><p>Ensuring a MongoDB Replica Set Member's Priority Takeover Succeeds</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/alexbevi">Alex Bevilacqua</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.2.4" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/adventure/">adventure</a> <a class="post-tag btn btn-outline-primary" href="/tags/mongodb/">mongodb</a> <a class="post-tag btn btn-outline-primary" href="/tags/sierra-on-line/">Sierra On-Line</a> <a class="post-tag btn btn-outline-primary" href="/tags/drivers/">drivers</a> <a class="post-tag btn btn-outline-primary" href="/tags/ruby/">ruby</a> <a class="post-tag btn btn-outline-primary" href="/tags/redmine/">redmine</a> <a class="post-tag btn btn-outline-primary" href="/tags/rpg/">rpg</a> <a class="post-tag btn btn-outline-primary" href="/tags/sci/">SCI</a> <a class="post-tag btn btn-outline-primary" href="/tags/book/">book</a> <a class="post-tag btn btn-outline-primary" href="/tags/jrpg/">jrpg</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> var disqus_config = function () { this.page.url = 'https://www.alexbevi.com/blog/2021/10/07/mongodb-versioned-api/'; this.page.identifier = '/blog/2021/10/07/mongodb-versioned-api/'; }; function addDisqus() { let disqusThread = document.createElement('div'); let paragraph = document.createElement('p'); disqusThread.id = 'disqus_thread'; paragraph.className = 'text-center text-muted small'; paragraph.innerHTML = 'Comments powered by <a href="https://disqus.com/">Disqus</a>.'; disqusThread.appendChild(paragraph); const footer = document.querySelector('footer'); footer.insertAdjacentElement("beforebegin", disqusThread); }function reloadDisqus(event) { if (event.source === window && event.data && event.data.id === Theme.ID) {if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } addDisqus(); if (Theme.switchable) { addEventListener('message', reloadDisqus); }var disqusObserver = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { var d = document, s = d.createElement('script'); s.src = 'https://alexbevi.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); disqusObserver.disconnect(); } }, { threshold: [0] } ); disqusObserver.observe(document.getElementById('disqus_thread')); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
